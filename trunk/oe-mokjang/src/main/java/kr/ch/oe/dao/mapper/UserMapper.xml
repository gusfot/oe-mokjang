<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.ch.oe.dao.UserMapper">
  <resultMap id="BaseResultMap" type="kr.ch.oe.model.User">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jan 08 11:00:07 KST 2015.
    -->
    <id column="user_id" jdbcType="VARCHAR" property="userId" />
    <result column="user_seq" jdbcType="BIGINT" property="userSeq" />
    <result column="user_name" jdbcType="VARCHAR" property="userName" />
    <result column="reg_dt" jdbcType="VARCHAR" property="regDt" />
    <result column="password" jdbcType="VARCHAR" property="password" />
    <result column="addr" jdbcType="VARCHAR" property="addr" />
    <result column="cell_phone" jdbcType="VARCHAR" property="cellPhone" />
    <result column="home_phone" jdbcType="VARCHAR" property="homePhone" />
    <result column="job" jdbcType="VARCHAR" property="job" />
    <result column="gender" jdbcType="CHAR" property="gender" />
    <result column="birth" jdbcType="VARCHAR" property="birth" />
    <result column="email" jdbcType="VARCHAR" property="email" />
    <result column="dept_seq" jdbcType="BIGINT" property="deptSeq" />
    <result column="reg_time" jdbcType="TIMESTAMP" property="regTime" />
    <result column="role_seq" jdbcType="BIGINT" property="roleSeq" />
    <result column="role_name" jdbcType="VARCHAR" property="roleName" />
    <result column="flag" jdbcType="VARCHAR" property="flag" />
    
  </resultMap>
  
  <resultMap type="kr.ch.oe.model.User" id="UserResultMap" extends="BaseResultMap">
  	<association property="department" columnPrefix="dept_" resultMap="DepartmentResultMap"/>
  	<association property="role" columnPrefix="role_" resultMap="RoleResultMap"/>
  	<collection property="eduStatusList" columnPrefix="es_" resultMap="EduStatusResultMap" />
  	<collection property="missionWorkStatusList" columnPrefix="mws_" resultMap="MissionWorkStatusResultMap" />
  </resultMap>
  
  <resultMap type="kr.ch.oe.model.Department" id="DepartmentResultMap">
  	 <id column="dept_seq" jdbcType="BIGINT" property="deptSeq" />
    <result column="dept_name" jdbcType="VARCHAR" property="deptName" />
    <result column="parent_seq" jdbcType="BIGINT" property="parentSeq" />
    <result column="reg_time" jdbcType="VARCHAR" property="regTime" />
  </resultMap>
  
  
  <resultMap type="kr.ch.oe.model.Role" id="RoleResultMap">
  	 <id column="role_seq" jdbcType="BIGINT" property="roleSeq" />
    <result column="role_name" jdbcType="VARCHAR" property="roleName" />
    <result column="reg_time" jdbcType="TIMESTAMP" property="regTime" />
  </resultMap>
  
  <resultMap type="kr.ch.oe.model.EduStatus" id="EduStatusResultMap">
  	 <id column="edu_status_seq" jdbcType="BIGINT" property="eduStatusSeq" />
    <result column="user_id" jdbcType="VARCHAR" property="userId" />
    <result column="edu_seq" jdbcType="BIGINT" property="eduSeq" />
    <result column="edu_date" jdbcType="VARCHAR" property="eduDate" />
    <result column="edu_name" jdbcType="VARCHAR" property="eduName" />
    <result column="edu_unit" jdbcType="BIGINT" property="eduUnit" />
    <result column="state" jdbcType="CHAR" property="state" />
    <result column="reg_id" jdbcType="VARCHAR" property="regId" />
    <result column="reg_time" jdbcType="TIMESTAMP" property="regTime" />
  </resultMap>
  
  <resultMap type="kr.ch.oe.model.MissionWorkStatus" id="MissionWorkStatusResultMap">
  	 <id column="mission_work_status_seq" jdbcType="BIGINT" property="missionWorkStatusSeq" />
    <result column="user_id" jdbcType="VARCHAR" property="userId" />
    <result column="new_user_id" jdbcType="VARCHAR" property="newUserId" />
    <result column="reg_date" jdbcType="VARCHAR" property="regDate" />
    <result column="reg_id" jdbcType="VARCHAR" property="regId" />
    <result column="reg_time" jdbcType="TIMESTAMP" property="regTime" />
  </resultMap>

  <sql id="Example_Where_Clause">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jan 08 11:00:07 KST 2015.
    -->
    <where>
      <foreach collection="oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jan 08 11:00:07 KST 2015.
    -->
    <where>
      <foreach collection="example.oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jan 08 11:00:07 KST 2015.
    -->
    user_id, user_seq, user_name, reg_dt, password, addr, cell_phone, home_phone, job, 
    gender, birth, email, dept_seq, reg_time, role_seq, role_name,flag
  </sql>
  <sql id="User_Column_List">
    user.user_id, 
    user.user_seq, 
    user.user_name, 
    user.reg_dt, 
    user.password, 
    user.addr, 
    user.cell_phone, 
    user.home_phone, 
    user.job, 
    user.gender, 
    user.birth, 
    user.email, 
    user.dept_seq, 
    user.reg_time, 
    user.role_seq,
    user.flag
  </sql>
  <sql id="Dept_Column_List">
    dept.dept_seq dept_dept_seq , 
    dept.dept_name dept_dept_name, 
    dept.parent_seq dept_parent_seq, 
    dept.reg_time dept_reg_time 
  </sql>
  <sql id="Role_Column_List">
    role.role_seq role_role_seq, 
    role.role_name role_role_name, 
    role.reg_time role_reg_time 
  </sql>
  <sql id="StudyStatus_Column_List">
    ss.study_status_seq ss_study_status_seq,
    ss.user_id ss_user_id ,
    ss.edu_seq ss_edu_seq, 
    ss.study_date ss_study_date, 
    ss.study_unit ss_study_unit ,
    ss.state ss_state, 
    ss.reg_id ss_reg_id, 
    ss.reg_time ss_reg_time 
  </sql>
  <sql id="MissisonWorkStatus_Column_List">
    mws.mission_work_status_seq mws_mission_work_status_seq, 
    mws.user_id mws_user_id,
    mws.new_user_id mws_new_user_id,
    mws.reg_date mws_reg_date,
    mws.reg_id mws_reg_id,
    mws.reg_time mws_reg_time
  </sql>
  <sql id="EduStatus_Column_List">
    es.edu_status_seq es_edu_satus_seq,
    es.user_id es_user_id,
    es.edu_seq es_edu_seq,
    es.edu_name es_edu_name,
    es.edu_date es_edu_date, 
    es.edu_unit es_edu_unit,
    es.state es_state, 
    es.reg_id es_reg_id,
    es.reg_time es_reg_time
  </sql>
  
  <select id="selectByExample" parameterType="kr.ch.oe.model.UserExample" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jan 08 11:00:07 KST 2015.
    -->
    select
    <if test="distinct">
      distinct
    </if>
    <include refid="Base_Column_List" />
    from user
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null">
      order by ${orderByClause}
    </if>
    <if test="limitByClause != null">
    limit ${limitByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jan 08 11:00:07 KST 2015.
    -->
    select 
    <include refid="Base_Column_List" />
    from user
    where user_id = #{userId,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jan 08 11:00:07 KST 2015.
    -->
    delete from user
    where user_id = #{userId,jdbcType=VARCHAR}
  </delete>
  <delete id="deleteByExample" parameterType="kr.ch.oe.model.UserExample">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jan 08 11:00:07 KST 2015.
    -->
    delete from user
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="kr.ch.oe.model.User">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jan 08 11:00:07 KST 2015.
    -->
    insert into user (user_id, user_seq, user_name, 
      reg_dt, password, addr, 
      cell_phone, home_phone, job, 
      gender, birth, email, 
      dept_seq, reg_time, role_seq, role_name,flag
      )
    values (#{userId,jdbcType=VARCHAR}, #{userSeq,jdbcType=BIGINT}, #{userName,jdbcType=VARCHAR}, 
      #{regDt,jdbcType=VARCHAR}, #{password,jdbcType=VARCHAR}, #{addr,jdbcType=VARCHAR}, 
      #{cellPhone,jdbcType=VARCHAR}, #{homePhone,jdbcType=VARCHAR}, #{job,jdbcType=VARCHAR}, 
      #{gender,jdbcType=CHAR}, #{birth,jdbcType=VARCHAR}, #{email,jdbcType=VARCHAR}, 
      #{deptSeq,jdbcType=BIGINT}, #{regTime,jdbcType=TIMESTAMP}, #{roleSeq,jdbcType=CHAR}, 
      #{roleName,jdbcType=VARCHAR},#{flag,jdbcType=VARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="kr.ch.oe.model.User">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jan 08 11:00:07 KST 2015.
    -->
    insert into user
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="userId != null">
        user_id,
      </if>
      <if test="userSeq != null">
        user_seq,
      </if>
      <if test="userName != null">
        user_name,
      </if>
      <if test="regDt != null">
        reg_dt,
      </if>
      <if test="password != null">
        password,
      </if>
      <if test="addr != null">
        addr,
      </if>
      <if test="cellPhone != null">
        cell_phone,
      </if>
      <if test="homePhone != null">
        home_phone,
      </if>
      <if test="job != null">
        job,
      </if>
      <if test="gender != null">
        gender,
      </if>
      <if test="birth != null">
        birth,
      </if>
      <if test="email != null">
        email,
      </if>
      <if test="deptSeq != null">
        dept_seq,
      </if>
      <if test="regTime != null">
        reg_time,
      </if>
      <if test="roleSeq != null">
        role_seq,
      </if>
      <if test="roleName != null">
        role_name,
      </if>
      <if test="flag != null">
        flag
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="userId != null">
        #{userId,jdbcType=VARCHAR},
      </if>
      <if test="userSeq != null">
        #{userSeq,jdbcType=BIGINT},
      </if>
      <if test="userName != null">
        #{userName,jdbcType=VARCHAR},
      </if>
      <if test="regDt != null">
        #{regDt,jdbcType=VARCHAR},
      </if>
      <if test="password != null">
        #{password,jdbcType=VARCHAR},
      </if>
      <if test="addr != null">
        #{addr,jdbcType=VARCHAR},
      </if>
      <if test="cellPhone != null">
        #{cellPhone,jdbcType=VARCHAR},
      </if>
      <if test="homePhone != null">
        #{homePhone,jdbcType=VARCHAR},
      </if>
      <if test="job != null">
        #{job,jdbcType=VARCHAR},
      </if>
      <if test="gender != null">
        #{gender,jdbcType=CHAR},
      </if>
      <if test="birth != null">
        #{birth,jdbcType=VARCHAR},
      </if>
      <if test="email != null">
        #{email,jdbcType=VARCHAR},
      </if>
      <if test="deptSeq != null">
        #{deptSeq,jdbcType=BIGINT},
      </if>
      <if test="regTime != null">
        #{regTime,jdbcType=TIMESTAMP},
      </if>
      <if test="roleSeq != null">
        #{roleSeq,jdbcType=CHAR},
      </if>
      <if test="roleName != null">
        #{roleName,jdbcType=VARCHAR},
      </if>
      <if test="flag != null">
        #{flag,jdbcType=VARCHAR}
      </if>
      
    </trim>
  </insert>
  <select id="countByExample" parameterType="kr.ch.oe.model.UserExample" resultType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jan 08 11:00:07 KST 2015.
    -->
    select count(*) from user
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jan 08 11:00:07 KST 2015.
    -->
    update user
    <set>
      <if test="record.userId != null">
        user_id = #{record.userId,jdbcType=VARCHAR},
      </if>
      <if test="record.userSeq != null">
        user_seq = #{record.userSeq,jdbcType=BIGINT},
      </if>
      <if test="record.userName != null">
        user_name = #{record.userName,jdbcType=VARCHAR},
      </if>
      <if test="record.regDt != null">
        reg_dt = #{record.regDt,jdbcType=VARCHAR},
      </if>
      <if test="record.password != null">
        password = #{record.password,jdbcType=VARCHAR},
      </if>
      <if test="record.addr != null">
        addr = #{record.addr,jdbcType=VARCHAR},
      </if>
      <if test="record.cellPhone != null">
        cell_phone = #{record.cellPhone,jdbcType=VARCHAR},
      </if>
      <if test="record.homePhone != null">
        home_phone = #{record.homePhone,jdbcType=VARCHAR},
      </if>
      <if test="record.job != null">
        job = #{record.job,jdbcType=VARCHAR},
      </if>
      <if test="record.gender != null">
        gender = #{record.gender,jdbcType=CHAR},
      </if>
      <if test="record.birth != null">
        birth = #{record.birth,jdbcType=VARCHAR},
      </if>
      <if test="record.email != null">
        email = #{record.email,jdbcType=VARCHAR},
      </if>
      <if test="record.deptSeq != null">
        dept_seq = #{record.deptSeq,jdbcType=BIGINT},
      </if>
      <if test="record.regTime != null">
        reg_time = #{record.regTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.roleSeq != null">
        role_seq = #{record.roleSeq,jdbcType=CHAR},
      </if>
      <if test="record.roleName != null">
        role_name = #{record.rolename,jdbcType=VARCHAR},
      </if>
      <if test="record.flag != null">
        role_flag = #{record.flag,jdbcType=VARCHAR}
      </if>
    </set>
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jan 08 11:00:07 KST 2015.
    -->
    update user
    set user_id = #{record.userId,jdbcType=VARCHAR},
      user_seq = #{record.userSeq,jdbcType=BIGINT},
      user_name = #{record.userName,jdbcType=VARCHAR},
      reg_dt = #{record.regDt,jdbcType=VARCHAR},
      password = #{record.password,jdbcType=VARCHAR},
      addr = #{record.addr,jdbcType=VARCHAR},
      cell_phone = #{record.cellPhone,jdbcType=VARCHAR},
      home_phone = #{record.homePhone,jdbcType=VARCHAR},
      job = #{record.job,jdbcType=VARCHAR},
      gender = #{record.gender,jdbcType=CHAR},
      birth = #{record.birth,jdbcType=VARCHAR},
      email = #{record.email,jdbcType=VARCHAR},
      dept_seq = #{record.deptSeq,jdbcType=BIGINT},
      reg_time = #{record.regTime,jdbcType=TIMESTAMP},
      role_seq = #{record.roleSeq,jdbcType=CHAR},
      role_name = #{record.roleName,jdbcType=VARCHAR},
      flag = #{record.flag,jdbcType=VARCHAR}
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="kr.ch.oe.model.User">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jan 08 11:00:07 KST 2015.
    -->
    update user
    <set>
      <if test="userSeq != null">
        user_seq = #{userSeq,jdbcType=BIGINT},
      </if>
      <if test="userName != null">
        user_name = #{userName,jdbcType=VARCHAR},
      </if>
      <if test="regDt != null">
        reg_dt = #{regDt,jdbcType=VARCHAR},
      </if>
      <if test="password != null">
        password = #{password,jdbcType=VARCHAR},
      </if>
      <if test="addr != null">
        addr = #{addr,jdbcType=VARCHAR},
      </if>
      <if test="cellPhone != null">
        cell_phone = #{cellPhone,jdbcType=VARCHAR},
      </if>
      <if test="homePhone != null">
        home_phone = #{homePhone,jdbcType=VARCHAR},
      </if>
      <if test="job != null">
        job = #{job,jdbcType=VARCHAR},
      </if>
      <if test="gender != null">
        gender = #{gender,jdbcType=CHAR},
      </if>
      <if test="birth != null">
        birth = #{birth,jdbcType=VARCHAR},
      </if>
      <if test="email != null">
        email = #{email,jdbcType=VARCHAR},
      </if>
      <if test="deptSeq != null">
        dept_seq = #{deptSeq,jdbcType=BIGINT},
      </if>
      <if test="regTime != null">
        reg_time = #{regTime,jdbcType=TIMESTAMP},
      </if>
      <if test="roleSeq != null">
        role_seq = #{roleSeq,jdbcType=CHAR},
      </if>
      <if test="roleName != null">
        role_name = #{roleName,jdbcType=VARCHAR},
      </if>
      <if test="flag != null">
        flag = #{flag,jdbcType=VARCHAR}
      </if>
      
    </set>
    where user_id = #{userId,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="kr.ch.oe.model.User">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jan 08 11:00:07 KST 2015.
    -->
    update user
    set user_seq = #{userSeq,jdbcType=BIGINT},
      user_name = #{userName,jdbcType=VARCHAR},
      reg_dt = #{regDt,jdbcType=VARCHAR},
      password = #{password,jdbcType=VARCHAR},
      addr = #{addr,jdbcType=VARCHAR},
      cell_phone = #{cellPhone,jdbcType=VARCHAR},
      home_phone = #{homePhone,jdbcType=VARCHAR},
      job = #{job,jdbcType=VARCHAR},
      gender = #{gender,jdbcType=CHAR},
      birth = #{birth,jdbcType=VARCHAR},
      email = #{email,jdbcType=VARCHAR},
      dept_seq = #{deptSeq,jdbcType=BIGINT},
      reg_time = #{regTime,jdbcType=TIMESTAMP},
      role_seq = #{roleSeq,jdbcType=CHAR},
      role_name = #{roleName.jdbcType=VARCHAR},
      flag = #{flag.jdbcType=VARCHAR}
    where user_id = #{userId,jdbcType=VARCHAR}
  </update>
  
  <select id="selectByUserId" parameterType="string" resultMap="UserResultMap">
    select 
    <include refid="User_Column_List" />
    ,<include refid="Dept_Column_List" />
    ,<include refid="EduStatus_Column_List" />
    ,<include refid="MissisonWorkStatus_Column_List" />
    ,<include refid="Role_Column_List" />
    from user user
    left outer join dept dept on dept.dept_seq = user.dept_seq
    left outer join ( select es.*, edu.edu_name from edu_status es inner join edu edu on edu.edu_seq=es.edu_seq) es on es.user_id = user.user_id 
    left outer join mission_work_status mws on mws.user_id = user.user_id 
    left outer join (select rolemapping.*,role.role_name  from role_mapping rolemapping inner join role on role.role_seq = rolemapping.role_seq ) role on role.role_seq = user.role_seq
    where user.user_id = #{userId,jdbcType=VARCHAR}
  </select>
  <select id="selectOverlapUserId" parameterType="string" resultType="string">
    select 
	user_id	
    from user user
    where user.user_id = #{userId,jdbcType=VARCHAR}
  </select>
  
  <select id="selectRoleName" parameterType="long" resultType="string">
    select 
	role_name
    from role role
    where role.role_seq = #{roleSeq,jdbcType=VARCHAR}
  </select>
  
  
</mapper>